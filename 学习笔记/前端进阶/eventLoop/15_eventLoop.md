### 1 浏览器的事件环（代码的执行顺序）

js的“主线程”是单线程的

#### 1 进程的概念

计算机在调度任务时，是以进程为单位 也是分配任务的最小单位

浏览器他是一个多进程的（每一页卡都是一个进程）

浏览器有一个主进程 用户的界面

每个页卡里 都有一个渲染进程（浏览器内核）

处理请求 网络进程

绘图绘制 GPU渲染进程

其他的 浏览器插件



##### 渲染进程！！！（包含多个线程）主要的 前端

UI渲染线程

js引擎 执行Js的 （ui和js是互斥的 共用同一个线程）

事件线程 click 定时器 settimeout ajax 也是一个独立的线程

单独的调度线程 处理事件 处理定时器到时间 ajax成功了 （事件触发线程 eventLoop）



常见的方法“异步的”方法分为两类 宏任务【点击事件也是宏任务】（宿主环境提供的异步方法 都是宏任务） 微任务（语言标准提供的 prmise.then肯定不是定时器  mutationObserver）



#### 2 js的执行顺序

默认代码从上到下执行 执行环境通过script来执行（宏任务）

在代码执行的过程中 调用定时器 promise click事件......, 不会立即执行 需要等待当前代码全部执行完毕

给异步方法划分队列 分别存放到 微任务（立即存放）和宏任务（是时间到了 或者事情发生了）（队列）中

script执行完毕后 会清空所有的微任务

执行完毕后 会渲染页面 ui渲染 （不是每次都会调用）

再去宏任务队列中看看有没有到达时间的 拿出来其中一个执行

执行完毕后 按照上述步骤不停的循环

![eventLoop](../../../图片/异步和事件环/eventLoop.jpg)


### 2 node中也有自己的事件循环机制

浏览器和node事件环的执行结果 在node10版本以后就一致 执行的方式不一样

promise1\ promise2 \

宏任务：【settIMEout2, settimeout2】

微任务: [promise1]